---
layout: post
title: "Data Pig - 数据类型"
description: ""
category: Hadoop
tags: [Hadoop, Pig]
---
{% include JB/setup %}

Pig 数据类型主要分为两种类型：标量（Scalar）类型，它只包含单一的值；复合（Complex）类型，它可以包含多个值，可以是不同类型。

### 标量类型（Scalar Type）

Pig 的标量类型和其他语言的类似，都是简单的类型。除了 byteArray 之外，其他的都可以
在 java.lang 类中找到相对应的类型，这样使得 UDF（用户定制函数）更容易构建：

#### 整型 int

整数。Ints 在 Java 中对应的类是 Java.lang.Integer；4位有符号整型；表达形式为整数
，例如 42；

#### 长整型 long

长整数。Longs 在 Java 中对应的类是 Java.lang.Long；8位有符号的整型；表达形式为
整数＋L后缀，例如 500000000L；

#### 浮点型 float

浮点型数字。Floats 在 Java 中对应的类是 Java.lang.Float；4位字节；表达形式为
浮点数＋f 后缀，例如 3.14f；或者指数表达形式，例如 6.022e23f;

#### 双精度浮点型 double

双精度点型数字。Doubles 在 Java 中对应的类是 Java.lang.Double；4位字节；表达形式
为浮点数，例如 3.1415926；或者指数表达形式，例如 6.022e-34;

> ##### 注释
> 你可以在 http:gi/java.sun.com/docs/books/jls/ third_edition/html/typesValues.html#4.2.3.
> 网站上找到浮点型和双精度浮点型的取值范围。注意，因为是浮点数，所以在一些计算
> 时会导致精度缺失；如果需要保持精度，你应该使用 int 或者 float。

#### 字符数组 chararray

字符串或字符数组。Chararray 在 Java 中对应的类是 Java.lang.String。它的表达形式
是由单引号包围的字符串字画量，例如 'fred'。除了标准的字符和符号字符外，我们需要
使用反斜杠来转移部分特殊字符，比如, tab `\t`，换行符 `\n`。Unicode 字符使用
`\u` 前缀 ＋ 四位16进制的Unicode值；例如，`ctrl-A` 表达为 `\u0001`；

#### 字节数组 bytearray

一个大型2进制对象或者字节数组。Bytearrays 在 Java 中对应的类是 DataByteArray；
没有办法指定一个字节数组常量。

### 复合（Complex）类型

Pig 有三种复合数据类型：maps，tuples 和 bags。所有的这些类型都可以包含在其它的
符合类型中。因此，可能存在 map 类型的值中包含一个 bag，而这个 bag 中还包含了一个
元组。

#### Map

Pig 的 Map 数据是指字符串到数据元素的映射（Mapping），它的元素可以是任何 Pig 类型
，包括复合类型。字符串被称为键（Key），被用来作为索引来帮助查找元素。

因为 Pig 不知道值的类型，所以他将会假设值是一个字节码（Bytearray）。然而，实际的
值可能会有所不同。如果你知道它的实际类型，你就可以转换（Cast）它。如果你不对他做
类型转换，Pig 将会根据你的使用方法来作出最佳的假设。如果值不是 bytearray， Pig将
在运行时对他进行处理。

默认，Pig 没有要求 Map 中的各个值必须是同种类型。如果 map 中有姓名和年龄的话，也
是合法的。从 Pig 0.9 开始，Map 数据类型中的各个值必须是同种类型的；这是很有用，就
可以减轻系统的负担，不用遍历每一个元素。

Map 常量使用方括号［bracket］来界定该类型的，哈希键值，键值之间使用井号隔开，键值
对之间使用逗号（comma）隔开；例如，['name'#'bob','age'#55] 将会创建一个有两个键的
 map；第一个值是一个字符串，第二个值是一个整型。

#### 元组 Tuple

元组是一个可调整长度，有序的数据集合。元组包含多个字段（fields）；每个字段包含一
个数据元素；每一个字段可以是任何类型，不需要保持同种类型。元组类比 SQL 中的行。
还有元组是有序的，所以可以通过位置来取相应的值。元组可以，但不是必须，关联一个
模式（schema），用来描述各个字段的类型，还可以为字段提供一个名称，来方便取值。
这样使得允许用户检查元组的数据，通过字段名索引相应字段。

元组常量使用圆括号（paranthese）来指定，每个字段之间使用逗号（comma）隔开；例如，
('meo', 27)。

#### Bag

Bag 是一种无序元组的组合。因为他无序，所以他不能通过位子索引元素。和元组一样，它\
可以但不是必须有有一个模式（schema）来关联它。

Bag 常量使用花括号（braces），其中的元组（tuple）使用逗号（comma）隔开。例如，\
{('meo', 27), ('cm', 29), ('jl', 26)}。

Pig 用户通常会注意到，Pig 没有提供列表（list）和 set 类型。它可能是因为可以使用\
bag 来模拟一个 set，通过使用一个元素的元组来分装。虽然做法有点傻，但是它生效。

Bag 是 Pig 类型中，不需要受 内存限制的。你后面将会看到，因为他用来存储分组后的\
集合，所以 bag 可能很大。如果必要，Pig 可以把 bag 存储在磁盘中，只有 bag 中的\
部分存储在内存中。bag 到大小限制是可用的磁盘空间。

> ### Pig 数据的内存要求

> 在之前的章节，我都会提到每个类型存储的大小。这就是告诉你这个值占用多少内存。而\
> 不是告诉你存储这个值的对象的到校。Pig 使用 Java 对象内部呈现这些值；所以还需要\
> 多余的空间来存储它。这个多出来的空间取决于你使用的 JVM，但是通常占用 8 个字节\
> 。最糟糕的是字符串（chararray），因为 Java 字符串中的每个字符占用两个字节。
>
> 因此，如果你要计算 Pig 处理数据需要的存储量，不要计算硬盘中的字节数，而是算你\
> 需要的内存。硬盘和内存的乘积关系依赖你的数据，是否被压缩，还有你的磁盘格式等\
> 等。作为参考，存储在内存的一倍数据量，就需要四倍的磁盘空间（未压缩的）。

#### Nulls

Pig 的数据类型可以是空值（null）。任何类型的数据都可以为空。Pig 空值的概念和 SQL\
中的相同，但是完全不同与 C，Java，Python 等等语言的空值。Pig 中的空值意味着位置\
。可能由于数据丢失，处理时发生错误等等原因。在大部分过程（procedural）语言中，\
当未被设定或者未指向相应的地址或对象时被称作空。这样的差异导致 Pig 处理空值的方\
式差异很大。

不象 SQL，Pig 没有限制（constraints）的概念。根据 null 的定义，这意味着任何数据\
元素可以永远是空。这个需要在你编写 Pig 脚本时，需要牢记的。
