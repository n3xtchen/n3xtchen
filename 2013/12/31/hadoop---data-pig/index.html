<!doctype html><html lang=zh-cn dir=ltr class=scroll-smooth data-default-appearance=light data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="zh-CN"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><title>Data Pig - Pig 简介 &#183; N3xtChen 的博客</title>
<meta name=title content="Data Pig - Pig 简介 &#183; N3xtChen 的博客"><meta name=description content="Pig Eat Data"><meta name=keywords content="hadoop,pig,"><link rel=canonical href=https://n3xtchen.github.io/n3xtchen/2013/12/31/hadoop---data-pig/><link type=text/css rel=stylesheet href=/n3xtchen/css/main.bundle.min.5775579083e26679417a451dd3d7c3e540c7be85426fba5a47019603552ac89b95e12dddb64138e0aa488d68bc318ec4b0820255a5859b4da3f1b45f140abf11.css integrity="sha512-V3VXkIPiZnlBekUd09fD5UDHvoVCb7paRwGWA1UqyJuV4S3dtkE44KpIjWi8MY7EsIICVaWFm02j8bRfFAq/EQ=="><script type=text/javascript src=/n3xtchen/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj+e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script><script defer type=text/javascript id=script-bundle src=/n3xtchen/js/main.bundle.min.16f0f751c741e0cb050737b714c11072d5714e4f315106a0abcf4f42ddc005ebc6c67e7b6b88d5410d568803fbe844fa0c176d2a2c6afca8697f42d3ea594c83.js integrity="sha512-FvD3UcdB4MsFBze3FMEQctVxTk8xUQagq89PQt3ABevGxn57a4jVQQ1WiAP76ET6DBdtKixq/Khpf0LT6llMgw==" data-copy data-copied></script><script src=/n3xtchen/js/zoom.min.js></script><link rel=icon href=/n3xtchen/favicon.png pe=image/png><meta property="og:title" content="Data Pig - Pig 简介"><meta property="og:description" content="Pig Eat Data"><meta property="og:type" content="article"><meta property="og:url" content="https://n3xtchen.github.io/n3xtchen/2013/12/31/hadoop---data-pig/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2013-12-31T00:00:00+00:00"><meta property="article:modified_time" content="2013-12-31T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Data Pig - Pig 简介"><meta name=twitter:description content="Pig Eat Data"><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"时间线","name":"Data Pig - Pig 简介","headline":"Data Pig - Pig 简介","description":"Pig Eat Data","abstract":"什么是 Pig?","inLanguage":"zh-CN","url":"https:\/\/n3xtchen.github.io\/n3xtchen\/2013\/12\/31\/hadoop---data-pig\/","author":{"@type":"Person","name":"n3xtchen"},"copyrightYear":"2013","dateCreated":"2013-12-31T00:00:00\u002b00:00","datePublished":"2013-12-31T00:00:00\u002b00:00","dateModified":"2013-12-31T00:00:00\u002b00:00","keywords":["hadoop","pig"],"mainEntityOfPage":"true","wordCount":"667"}]</script><meta name=author content="n3xtchen"><link href=https://twitter.com/mN3XT rel=me><link href=https://githhub.com/n3xtchen rel=me><script src=/n3xtchen/lib/jquery/jquery.slim.min.js integrity></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-EMLJCHXBFD"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-EMLJCHXBFD")</script><meta name=theme-color><style>code.has-jax{-webkit-font-smoothing:antialiased;background:inherit!important;border:none!important;font-size:100%}</style><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"]}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span></a></div><div style=padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3"><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/n3xtchen class="text-base font-medium text-gray-500 hover:text-gray-900">N3xtChen 的博客</a></nav><nav class="hidden md:flex items-center space-x-5 md:ml-12 h-12"><a href=/n3xtchen/posts/ class="flex items-center"><p class="text-base font-medium text-gray-500 hover:text-gray-900" title=时间线>时间线</p></a><a href=/n3xtchen/categories/ class="flex items-center"><p class="text-base font-medium text-gray-500 hover:text-gray-900" title=分类页>分类</p></a><a href=/n3xtchen/tags/ class="flex items-center"><p class="text-base font-medium text-gray-500 hover:text-gray-900" title=标签>标签</p></a><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400 h-12" title>
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="ltr:mr-14 rtl:ml-14 cursor-pointer text-sm text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"><button id=appearance-switcher aria-label="Dark mode switcher" type=button><div class="flex items-center justify-center h-12 dark:hidden"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden h-12 dark:flex"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav><div class="flex md:hidden items-center space-x-5 md:ml-12"><span></span>
<button id=search-button-mobile aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title>
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button>
<button id=appearance-switcher-mobile aria-label="Dark mode switcher" type=button style=margin-right:5px><div class="flex items-center justify-center h-12 dark:hidden"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden h-12 dark:flex"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div><div class="-my-2 -mr-2 md:hidden"><label id=menu-button for=menu-controller class=block><input type=checkbox id=menu-controller class=hidden><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper style=padding-top:5px class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50"><ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl"><li><span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class=mt-1><a href=/n3xtchen/posts/ class="flex items-center"><p class="text-bg font-bg text-gray-500 hover:text-gray-900" title=时间线>时间线</p></a></li><li class=mt-1><a href=/n3xtchen/categories/ class="flex items-center"><p class="text-bg font-bg text-gray-500 hover:text-gray-900" title=分类页>分类</p></a></li><li class=mt-1><a href=/n3xtchen/tags/ class="flex items-center"><p class="text-bg font-bg text-gray-500 hover:text-gray-900" title=标签>标签</p></a></li></ul></div></label></div></div><div class="relative flex flex-col grow"><main id=main-content class=grow><article><header id=single_header class="mt-5 max-w-prose"><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Data Pig - Pig 简介</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center">&lt;time datetime="2013-12-31 00:00:00 &amp;#43;0000 UTC">2013-12-31&lt;/time>&lt;span class="px-2 text-primary-500">&amp;middot;&lt;/span>&lt;span>667 字&lt;/span>&lt;span class="px-2 text-primary-500">&amp;middot;&lt;/span>&lt;span title="预计阅读">4 分钟&lt;/span></div><div class="flex flex-row flex-wrap items-center"><span style=margin-top:.5rem class=mr-2 onclick='window.open("/n3xtchen/categories/hadoop/","_self")'><span class=flex><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Hadoop
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/n3xtchen/tags/hadoop/","_self")'><span class=flex><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">hadoop
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/n3xtchen/tags/pig/","_self")'><span class=flex><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">pig</span></span></span></div></div><div class=flex><img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width=96 height=96 alt=n3xtchen src=/n3xtchen/images/author.jpg><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">作者</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">n3xtchen</div><div class="text-sm text-neutral-700 dark:text-neutral-400">Sharing Funny Tech With You</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://twitter.com/mN3XT target=_blank aria-label=Twitter rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg></span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://githhub.com/n3xtchen target=_blank aria-label=Github rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></span></a></div></div></div></div><div class=mb-5></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first sm:max-w-prose lg:ml-auto px-0 lg:order-last lg:max-w-xs ltr:lg:pl-8 rtl:lg:pr-8"><div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-10"><details open class="mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden"></summary><div class="min-w-[220px] py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#什么是-pig>什么是 Pig?</a></li><li><a href=#hello-mapreduce>Hello, MapReduce</a></li><li><a href=#pig-latin一个并行的数据流语言>Pig Latin，一个并行的数据流语言</a></li><li><a href=#对比查询和数据流语言>对比查询和数据流语言</a><ul><li><a href=#pig-与-mapreduce-的区别>Pig 与 MapReduce 的区别</a></li></ul></li><li><a href=#pig-的适用场景>Pig 的适用场景</a><ul><li><a href=#etl-数据管道>ETL 数据管道</a><ul><li><a href=#etl-用例1数据清理和整合>ETL 用例1：数据清理和整合</a></li><li><a href=#etl-用例2离线计算创建行为预测模型>ETL 用例2：离线计算创建行为预测模型</a></li></ul></li><li><a href=#原始数据raw-data研究>原始数据（Raw Data）研究</a></li><li><a href=#数据迭代处理>数据迭代处理</a></li></ul></li><li><a href=#pig-哲学>Pig 哲学</a><ul><li><a href=#pigs-吃一切可以吃的东西>Pigs 吃一切可以吃的东西</a></li><li><a href=#pigs-无处不在>Pigs 无处不在</a></li><li><a href=#pigs-是家畜>Pigs 是家畜</a></li><li><a href=#飞猪在天>飞猪在天</a></li><li><a href=#pig-名称的由来>Pig 名称的由来</a></li></ul></li></ul></nav></div></details><details class="mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden"></summary><div class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#什么是-pig>什么是 Pig?</a></li><li><a href=#hello-mapreduce>Hello, MapReduce</a></li><li><a href=#pig-latin一个并行的数据流语言>Pig Latin，一个并行的数据流语言</a></li><li><a href=#对比查询和数据流语言>对比查询和数据流语言</a><ul><li><a href=#pig-与-mapreduce-的区别>Pig 与 MapReduce 的区别</a></li></ul></li><li><a href=#pig-的适用场景>Pig 的适用场景</a><ul><li><a href=#etl-数据管道>ETL 数据管道</a><ul><li><a href=#etl-用例1数据清理和整合>ETL 用例1：数据清理和整合</a></li><li><a href=#etl-用例2离线计算创建行为预测模型>ETL 用例2：离线计算创建行为预测模型</a></li></ul></li><li><a href=#原始数据raw-data研究>原始数据（Raw Data）研究</a></li><li><a href=#数据迭代处理>数据迭代处理</a></li></ul></li><li><a href=#pig-哲学>Pig 哲学</a><ul><li><a href=#pigs-吃一切可以吃的东西>Pigs 吃一切可以吃的东西</a></li><li><a href=#pigs-无处不在>Pigs 无处不在</a></li><li><a href=#pigs-是家畜>Pigs 是家畜</a></li><li><a href=#飞猪在天>飞猪在天</a></li><li><a href=#pig-名称的由来>Pig 名称的由来</a></li></ul></li></ul></nav></div></details></div></div><div class="min-w-0 min-h-0 max-w-fit"><div class="max-w-prose mb-20"><div id=什么是-pig class=anchor></div><h2 class="relative group">什么是 Pig?
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e4%bb%80%e4%b9%88%e6%98%af-pig aria-label=锚点>#</a></span></h2><p>Pig 提供了一个引擎在 Hadoop 集群上并行执行数据流。他包含一个语言，Pig Latin，
用来表达这些数据流。Pig Latin 可以执行一些传统的数据的操作（join, sort, filter
等等），同时也能让用户开发自自己的函数用来读，处理和写数据。</p><div id=hello-mapreduce class=anchor></div><h2 class="relative group">Hello, MapReduce
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#hello-mapreduce aria-label=锚点>#</a></span></h2><p>这边使用简单的单词计数程序演示 MapReduce。例子中，map 读取文本的每一行；然后拆成
一个词；shuffle 使用这些单词作为 key，并哈希化后传递给 reducers；reduce 将会汇总
起来计算它们出现的频度。这里有有一首打油诗 《Mary Had a Little Lamb》:</p><blockquote><p>Mary had a little lamb</p></blockquote><blockquote><p>its fleece was white as a snow</p></blockquote><blockquote><p>and everywhere that Mary went</p></blockquote><blockquote><p>the lamb was sure to go</p></blockquote><p>假设每一行发给不同的 map 任务。实际上，每一个 map 任务都会分配比这多的多的数据；
只是为了便于举例。</p><p>一旦 map 阶段完成，shuffle 阶段将会把相同的单词手机到相同的 reducer。这个例子，我
们假设有两个 reducers：所有单词分成两个：A-L 和 M-Z。每一个单词都将输出汇总个数。</p><p>Pig 使用 MapReduce 执行所有的数据处理。它把用户编写的 Pig Latin 脚本编译成一系列
一个或多个 MapReduce 构成的数据流，然后执行它。</p><pre><code>-- 载入名为 mary.txt 的文件
-- 把每一行命名为 line
my_input = load 'mary.txt' as (line)

-- TOKENIZE 将一行拆分成单词
-- flatten 将会获取 TOKENIZE 返回的集合，并为每个单词产生一条记录，并把他命名
-- 为word
words = foreach my_input generate flatten(TOKENIZE(line)) as word;

-- 现在按每一个单词分组
grpd = group words by word

-- 计数
cntd = foreach grpd generate group, COUNT(words);

-- 打印结果
dump cntd
</code></pre><p>当使用 Pig 时，我们不需要关心 map，shuffle 和 reduce。他将会分解操作到合适的任务中。</p><div id=pig-latin一个并行的数据流语言 class=anchor></div><h2 class="relative group">Pig Latin，一个并行的数据流语言
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#pig-latin%e4%b8%80%e4%b8%aa%e5%b9%b6%e8%a1%8c%e7%9a%84%e6%95%b0%e6%8d%ae%e6%b5%81%e8%af%ad%e8%a8%80 aria-label=锚点>#</a></span></h2><p>Pig Latin 是一个数据流语言。这意味着它允许用户描述数据应该怎么被读取，处理，然后
存储。这些数据流可以是线性的，就象上一个例子；它也可能很复杂，包含多个输入源连接
，根据不同的操作输出给不同的输出源。为了精确（数学），Pig Latin 脚本可以被描述为
有向非循环图（DAG），边缘是数据流，节点是操作。</p><p>这意味着 Pig Latin 看起来和大部分语言不一样。在 Pig 中，没有 if, 没有 for。因为
传统的过程式或对象式编程都是控制流式的，而数据流是程序的副作用。 相反，Pig Latin
集中数据流。</p><div id=对比查询和数据流语言 class=anchor></div><h2 class="relative group">对比查询和数据流语言
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e5%af%b9%e6%af%94%e6%9f%a5%e8%af%a2%e5%92%8c%e6%95%b0%e6%8d%ae%e6%b5%81%e8%af%ad%e8%a8%80 aria-label=锚点>#</a></span></h2><p>大部分人都认为 Pig Latin 是 SQL 的过程式版本。虽然他们很相似，但是还是有很多不同
的。SQL 是允许用户描述他们想要的答案，而不是描述如何作答；而 Pig Latin 是需要用户
描述如何处理输入的信息。</p><p>另一个不同是SQL是面向回答问题的。当用户想要同时做几个数据操作时，他们必须分开写查
询语句，将结果存在临时表中，或用子查询。然而，很多 SQL 用户发现子查询很迷惑忍，而
且难以合适地编写。</p><p>Pig 是将一长串的数据操作在脑中设计，因此他们不需要在倒置的写数据管道或者担心存储
数据到临时的表中。</p><p>假设一个案例，用户想要为一张表基于一个键分组，然后和第二张表连接查询。因为连接查
询发生在分组查询之后的，它必须被表达为子查询，或者两个查询（使用临时表存储中间结
果）。</p><p>SQL 实现:</p><pre><code>CREATE TEMP TABLE t1 AS
SELECT customer, sum(purchase) AS total_purchases
FROM transations
GROUP BY customer;

SELECT customer, total_purchases, zipcode
FROM t1, customer_profile
WHERE t1.customer = customer_profile.customer;
</code></pre><p>Pig 实现:</p><pre><code>-- 载入 transactions 文件，以用户分组，汇总他的付款
txns = load 'transactions' as (customer, purchase);
grouped = group txns by customer;
total   = foreach grouped generate group, SUM(txns.purchase) as tp;
-- 载入 customer_profile 文件
profile = load 'customer_profile' as (customer, zipcode);
-- 连接分组汇总后的交易记录和用户档案数据
answear = join total by group, profile by customer;
-- 把结果写到屏幕上
dump answear;
</code></pre><p>然而，他们各自设计的场景是不同的。SQL 是为关系数据库设计的，他存储的数据需要范式
化（normalized），模式（schema）以及适当的限制（constraints）是强制的。Pig 是为
Hadoop 设计的，有时它的模式是未知或者反常的。他可能不能被适当的现实，很少被范式化
。</p><p>一个关于人类语言和文化的例子可能会帮助你理解这些。我的妻子和我一起去法国一段时间
了。我平时很少说法语。但因为英语是贸易通用语言（也可能是因为美国和英国喜欢到法
国度假的缘故吧，^_^），所以在法国使用英语并没有障碍。相反，我的妻子经常说发育。她
经常有朋友来玩。她可以和这些人沟通。他可以理解法语不仅仅限于旅游用语。她在法国的
经历肯定要比我深刻多了，因为他会说本地语言。</p><p>SQL 是数据处理世界中的英语。他有很多优雅的特性，而且很多工具都了解他，因此他的入
门门槛非常低。而我们要使 Pig Latin 成为并行数据处理系统（例如，Hadoop）中的当地语
言。他可能学习曲线有点抖，但是它让我们更能利用 Hadoop 的本身优点。</p><div id=pig-与-mapreduce-的区别 class=anchor></div><h3 class="relative group">Pig 与 MapReduce 的区别
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#pig-%e4%b8%8e-mapreduce-%e7%9a%84%e5%8c%ba%e5%88%ab aria-label=锚点>#</a></span></h3><p>Pig 提供给用户在 MapReduce 之上的优势。Pig Latin 提供了所有标准的数据操作，例如
Join，filter，group by，order by，union 等等。MapReduce 提供的只是 group by 的操作
（他是实现是 shuffle ＋ reduce），他提供的 Order by 操作是简介利用 group 来实现的
。 Filter 和 展示勉强使用 Map 来实现。而且其他操作，尤其是 join，是不被提供的，必
须用户自己实现。</p><p>Pig 提供了一些复杂完整数据操作的实现方法。例如，由于数据集中的每个键的记录很少被分
发，被发到 reducers 的数据经常被扭曲。也就是说，一个reducer获取的数据可能是其他
reducer 的 10倍甚至更多。Pig 的 join 和 order by 操作就是为了解决这个问题的，来
均衡各个 reducers。但是，Pig 中的实现和 MapReduce 的实现是同样耗时的。</p><p>在 MapReduce 中，Map 和 Reduce 中的数据处理对于系统来说是很不透明的。这意味着
MapReduce 没有机会优化和检查用户的代码。相反，Pig可以分析 Pig Latin，理解用户描述
的数据流。这样就可以尽早地做错误检查（例如用户尝试把字符串添加到整型中）和代码优化
（例如 两个分组操作是否能合并）。</p><p>MapReduce 没有类型系统。这是有意而为之的，这样给了用户足够的灵活来使用他们自己的
数据类型和序列化工作。但是负面的影响就是很大程度上限制了系统检查用户代码错误的能力
。</p><p>所有的这些观点都证明了 Pig Latin 在编写和维护上都比使用 JAVA 编写的 MapReduce 耗
费更低的成本。在一个科学非常不严谨的实验中，我同时用 Pig Latin 和 MapReduce 编写
了同样的操作。代码如下</p><pre><code>-- 载入 users  文件，包含两个字段：name，age
Users   = load 'users' as (name, age);
-- 筛选用户年龄为 18岁到25岁 之间
Fltrd   = filter Users by age &gt;= 18 and age &lt;= 25;
-- 载入 pages 文件，也包含两个字段：user，url
Page   = load 'pages' as (user, url);
-- 连接 Fltrd(name) 和 Page(user) 数据
Jnd = join Fltrd by name, Page by user;
-- 以 url 来分组
Grpd    = group Jnd by url;
-- 汇总各个 url 的用户数
Smmd    = foreach Grpd generate group, COUNT(Jnd) as clicks;
-- 以 clicks 降序排列
Srtd    = order Smmd by clicks desc;
-- 取前五条
Top5    = limit Srtd 5;
-- 并将结果存储到 top5sites 文件中
store Top5 into 'top5sites';
</code></pre><p>在 Pig Latin 中，使用了 9 行代码，大概花了 15分钟的时间来编写和调试。同样的在
MapReduce 中实现大概需要 170 行的代码，并发了 4 个小时让他正常运行。Pig Latin 将
更加的抑郁维护，对于未来开发者来说更容易理解和修改代码。</p><p>当然，如果在算法开发上来说，Pig Latin 并不擅长。假设被给予足够的开发时间，一个好
的工程师永远能写出在通用系统运行性能良好的代码。对于非通用算法或者性能极端敏感的
开发， MapReduce 仍然是最好的选择。那同样的情况下，使用 JAVA 和 其他脚本语言（
例如，Python）又有什么区别呢？Java 更加强大，但是由于相对比较底层，他需要更长的开
发周期。因此，开发需要针对不同的工作选择不同的工具。</p><div id=pig-的适用场景 class=anchor></div><h2 class="relative group">Pig 的适用场景
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#pig-%e7%9a%84%e9%80%82%e7%94%a8%e5%9c%ba%e6%99%af aria-label=锚点>#</a></span></h2><p>以我个人经验而言，Pig 的使用场<up>景大致有三个：传统的 ETL(Etract transform
load) 数据管道（Data Pipeline），原始数据(Row Data)研究和迭代处理。</p><div id=etl-数据管道 class=anchor></div><h3 class="relative group">ETL 数据管道
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#etl-%e6%95%b0%e6%8d%ae%e7%ae%a1%e9%81%93 aria-label=锚点>#</a></span></h3><p>最大的使用场景要属数据管道了。</p><div id=etl-用例1数据清理和整合 class=anchor></div><h4 class="relative group">ETL 用例1：数据清理和整合
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#etl-%e7%94%a8%e4%be%8b1%e6%95%b0%e6%8d%ae%e6%b8%85%e7%90%86%e5%92%8c%e6%95%b4%e5%90%88 aria-label=锚点>#</a></span></h4><p>在入库前，分析访问日志，净化数据和对数据的预处理。 例如，数据载入集群中，
使用 Pig 清理来自各个点的脏数据。它也可以用于将 Web 日志与用户数据库数据整合，以至于可以将用户 cookie 和用户信息相互关联。</p><div id=etl-用例2离线计算创建行为预测模型 class=anchor></div><h4 class="relative group">ETL 用例2：离线计算创建行为预测模型
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#etl-%e7%94%a8%e4%be%8b2%e7%a6%bb%e7%ba%bf%e8%ae%a1%e7%ae%97%e5%88%9b%e5%bb%ba%e8%a1%8c%e4%b8%ba%e9%a2%84%e6%b5%8b%e6%a8%a1%e5%9e%8b aria-label=锚点>#</a></span></h4><p>使用 Pig 检索用户的网页交互，将用户分割成不同的群体。然后，根据不同的属性，
产生相应的数据模型，来预测如何促进用户的访问。使用这种方法，
来决策使用哪一类广告能更能促进用户，哪一类故事更能促进用户回访。</p><div id=原始数据raw-data研究 class=anchor></div><h3 class="relative group">原始数据（Raw Data）研究
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e5%8e%9f%e5%a7%8b%e6%95%b0%e6%8d%aeraw-data%e7%a0%94%e7%a9%b6 aria-label=锚点>#</a></span></h3><p>传统来看，即席查询（ad-hoc queries，比如 SQL）能更简单快速地分析数据。 然而
，对于 Raw Data 的研究，一些用户更喜欢使用 Pig Latin；因为 Raw Data 的结构
常常不可预知，可能不完成，甚至反常态，而 Pig 能够很好的处理嵌套的数据结构，
，这是 SQL 所不擅长的。因此，使用 Pig 来处理未清理和载入数据仓库的数据再合适
不够了。</p><p>另外，处理大数据的研究员经常使用 Perl 或者 Python 这类脚本语言来完成他们的处
理。有这些技术背景的用户更喜欢 Pig 的数据流风格而不是 SQL 的声明式查询风格。</p><div id=数据迭代处理 class=anchor></div><h3 class="relative group">数据迭代处理
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e6%95%b0%e6%8d%ae%e8%bf%ad%e4%bb%a3%e5%a4%84%e7%90%86 aria-label=锚点>#</a></span></h3><p>建立迭代处理模型的用户也正在转向使用 Pig。考虑到新网站需要追踪所有的新故事的访问情况。
在这个图谱中，每一个新故事（story）都是一个节点（node），连接线（edges）用来指明两个
故事之间（story）的关系。例如，所有关于即将到来的选举的故事被联系在一块。每隔5分钟，
都会有新的故事进入，数据处理引擎必须将这些都整合进图谱来。一些故事是新的，一些是更新
新故事的，一些是替代存在的故事的。一些数据操作需要在整个故事图谱中操作的。例如，一个
处理行为标记模型的处理需要将用户信息与整个故事图谱进行关联。每5分钟重新进行整体连表
是不可能，因为在合理硬件情况下，是不可能在 5分钟内处理完它的。但是，模型创建者只在
每日一次更新他们模型，因为这样意味着失去一整天的机会点。</p><p>为了解决这些问题，他可能首先在常规的基础上做一次所有的图谱关联，例如，每天。然后，
每五分钟做一次对新数据的关联，这些结果会合并到整个图谱关联产生的结果中。这个合并需要
几点注意，因为每五分钟的数据包含了在整个图谱中插入，更新和删除。这种合并可以使用
Pig Latin 可以并且很合理地进行表达。</p><p>把之前说的都归纳到一点就是 Pig（象 MapReduce）是面向数据批处理的。如果需要处理海量的
数据，Pig 是很好的选择。但是，它要求读一个文件的所有记录，并按一定顺序来输出结果。对于
需要写单一或者数据一小部分，或者按随机顺序查找许多不同记录的操作，Pig 就不适用了。</p><div id=pig-哲学 class=anchor></div><h2 class="relative group">Pig 哲学
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#pig-%e5%93%b2%e5%ad%a6 aria-label=锚点>#</a></span></h2><div id=pigs-吃一切可以吃的东西 class=anchor></div><h3 class="relative group">Pigs 吃一切可以吃的东西
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#pigs-%e5%90%83%e4%b8%80%e5%88%87%e5%8f%af%e4%bb%a5%e5%90%83%e7%9a%84%e4%b8%9c%e8%a5%bf aria-label=锚点>#</a></span></h3><p>Pig 可以处理的数据不管是不是元数据。它可以操作关联的，内嵌的，或者无结构的数据。并且
它可以通过简单拓展来操作任何形式的数据。</p><div id=pigs-无处不在 class=anchor></div><h3 class="relative group">Pigs 无处不在
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#pigs-%e6%97%a0%e5%a4%84%e4%b8%8d%e5%9c%a8 aria-label=锚点>#</a></span></h3><p>Pig 更像并行数据操作世界的一种语言。他并不是绑定给某一特定并行框架。首先，它可以用于
Hadoop，但我们不仅仅希望只用于 Hadoop。</p><div id=pigs-是家畜 class=anchor></div><h3 class="relative group">Pigs 是家畜
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#pigs-%e6%98%af%e5%ae%b6%e7%95%9c aria-label=锚点>#</a></span></h3><p>Pig 被设计成可以简单地被用户控制和修改。</p><p>它允许与用户代码整合，目前，它支持用户定义字段转换方法，用户定义的聚合操作以及用户定义
的条件。这些方法可以直接使用 Java 或者可以编译成 java 代码的脚本语言来编写。Pig 还支持
用户提供的数据载入和存储的方法。他支持通过它的 stream 命令在外部调用，以及通过 MapReduce
命令来操作它。他还允许用户在一些特定环境提供自定义分区或者设置 rduce 层次。</p><p>Pig 可以通过重新安排一些操作来优化性能。也很容易关掉他们。</p><div id=飞猪在天 class=anchor></div><h3 class="relative group">飞猪在天
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e9%a3%9e%e7%8c%aa%e5%9c%a8%e5%a4%a9 aria-label=锚点>#</a></span></h3><p>Pig 可以快速的处理数据。我们总是要提高它的性能，不会加入一些使它变重的功能。</p><blockquote><div id=pig-名称的由来 class=anchor></div><h3 class="relative group">Pig 名称的由来
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#pig-%e5%90%8d%e7%a7%b0%e7%9a%84%e7%94%b1%e6%9d%a5 aria-label=锚点>#</a></span></h3></blockquote><blockquote><p>“它为什么叫做 Pig？” 这个问题被问道的很频繁。人们也想知道 Pig 是不是一个宏语言。它不是。
整个故事是这样的；这个项目的研究人员最初只是简单地称它为 “Language”。最终，还是要给它取
个名字。一个研究人员突发奇想想出了 Pig 这个名称，起初大家都不接受。但是它出奇地好记而且容易
拼写。然而一部分人认为听起来难以出口甚至联想到愚蠢，他们为我们提供一个有趣的命名，例如，
Pig Latin 是语言， Grunt 是shell脚本，和 Piggybank 是 类 CPan 的分享资源库。</p></blockquote></div></div><script>var oid="views_posts/2013-12-31-hadoop---data-pig.md",oid_likes="likes_posts/2013-12-31-hadoop---data-pig.md"</script><script type=text/javascript src=/n3xtchen/js/page.min.0e49973b4ad0a382c7c6012d8bff8226316642daabc4f8a20477bd08674f3da6e2fa993bc20ad4f51e7c5bb68e6f913a207a7c4fe37ea0e7b806894afce0a64e.js integrity="sha512-DkmXO0rQo4LHxgEti/+CJjFmQtqrxPiiBHe9CGdPPabi+pk7wgrU9R58W7aOb5E6IHp8T+N+oOe4BolK/OCmTg=="></script></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="flex group mr-3" href=/n3xtchen/2013/11/25/python-django---simple/><span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&larr;</span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Python Django - simple guide</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2013-11-25 00:00:00 +0000 UTC">2013-11-25</time>
</span></span></a></span><span><a class="flex text-right group ml-3" href=/n3xtchen/2014/01/05/php-fig---psr-4/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">PHP FIG - PSR-4 自动载入（Autoloader）</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2014-01-05 00:00:00 +0000 UTC">2014-01-05</time>
</span></span><span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&larr;</span></a></span></div></div></footer></article><div id=top-scroller class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0"><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 backdrop-blur hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label title>&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2023
n3xtchen</p><p class="text-xs text-neutral-500 dark:text-neutral-400">由 <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://blowfish.page/ target=_blank rel="noopener noreferrer">Blowfish</a> 强力驱动</p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/n3xtchen/js/process.min.35c1113bcc16c5a59bf031082f9e63822aa95280423881a7847a7ff33a16e6299ce6a840d9ef4e10d947e030a18f3f20359afb2ec0f35967484b9a9360ac3145.js integrity="sha512-NcERO8wWxaWb8DEIL55jgiqpUoBCOIGnhHp/8zoW5imc5qhA2e9OENlH4DChjz8gNZr7LsDzWWdIS5qTYKwxRQ=="></script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]" data-url=https://n3xtchen.github.io/n3xtchen style=z-index:500><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title>
<span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>